<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>

    <style>
        *{
            
        }
        html,body{
            background-color: #557153;
        }
        .main_container{
            width: 1500px;
            margin-top: 100px;
            margin-left: 10px;
            background-color: #C8C2BC;
            border-radius: 10px;
            position:absolute;
        }
        .first_container{
            text-align: center;
            font-size: 25px;
            padding: 10px;
        }
        table,tr,th,td{
           border-collapse: collapse;
           height: 30px;
           text-align: center;
           font-size: 18px;
           text-transform: uppercase;
           border-bottom: 1px solid black;
           
        }
        th{
            font-size: 20px;
            height: 40px;
            background-color: #3F1D38;
            color: white;
        }
        td{
            padding: 8px;
        }
        .brance_name{
            font-size: 18px;
            font-weight: bolder;
            padding: 10px;
            text-align: left;
        }
        tr:hover{
            background-color: #008170;
            color: white;
            
        }
        #searchInput{
            width: 400px;
            height: 40px;
            margin-bottom: 10px;
            margin-left: 10px;
            border-radius: 10px;
        }
        input[type=text]:hover{
            font-size: 20px;
        }
        input[type=text]{
            font-size: 20px;
        }
        #resultDiv{
            width: 400px;
            text-transform: uppercase;
         
           color: green;
           font-size: 22px;
           margin-bottom: 10px;
           display: block;
        }
        button{
            color: black;
            background-color: #DDF2FD;
            text-transform: uppercase;
            width: 70px;
            height: 30px;
        }
        button:hover{
            color: white;
            background-color:red;
        }
        #editPopup{
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 20px;
            background-color: slategrey;
            border: 1px solid #ccc;
            z-index: 1000;
            margin-top: 30px;
            width: 450px;
          
        }
        #editPopup>input{
            margin-top: 10px;
            border-radius: 5px;
            height: 30px;
        }
        #editPopup>label{
         text-transform: uppercase;
         font-size: 17px;
        }
        .popupbtn{
            width: 200px;
            background-color: #008170;
            border-radius: 5px;
            color: aqua;
            margin-top: 10px;
            margin-left: 140px;
            font-size: 25px;
        }
        

    </style>
    <special-header></special-header>
    <script src="./headerfotermanager.js"></script>
    <div class="main_container">
    <div class="first_container">
        <div>NOMINAL ROLL OF SHIPS COMPANY</div>
        <div>B.N.S SHEIKH HASINA</div>
        <div id="dateDisplay"></div>
       </div>

       <input type="text" id="searchInput" oninput="searchTable()" placeholder="Search for data">
       <div id="resultDiv"></div>
   <table style="width: 100%;"  id="myTable">
        <thead>
            <tr>
                <th>S.NO</th>
                <th>O.NO</th>
                <th>NAME</th>
                <th>RANK</th>
                <th>PART-II</th>
                <th>GCB</th>
                <th>ID CARD <br> NO</th>
                <th>DATE OF <br> JOINING SHIP</th>
                <th>BLOOD <br> GROUP</th>
                <th>MOBILE NO</th>
                <th>MLR / VIC</th>
                <th>RMKS</th>
                <th>ACTION</th>
            </tr>
        </thead>
       
  
    
    <tr style="">
        <td colspan="13" class="brance_name">SEMAN</td>
    </tr>

    <tbody id="tableBody">

    </tbody >
   </table>

    </div>



    <script>


// Function to load and display data from local storage
function loadData() {


                   



    
            // Get data from local storage
            var allData = JSON.parse(localStorage.getItem("allData")) || [];

            // Get the table body
            var tableBody = document.getElementById("tableBody");

            // Clear existing rows in the table
            tableBody.innerHTML = "";

            // Loop through allData and add rows to the table
            for (var i = 0; i < allData.length; i++) {
                // Create a new table row element
                var newRow = document.createElement("tr");

                // Add cells for input data
                for (var j = 0; j < allData[i].length; j++) {
                    var newCell = document.createElement("td");
                    newCell.textContent = allData[i][j];
                    newRow.appendChild(newCell);
                    
                }

                // Add cell for edit and delete buttons
                var actionCell = document.createElement("td");
                actionCell.innerHTML =
                    "<button onclick='editRow(" + i + ")'>Edit</button> " +
                    "<button onclick='deleteRow(" + i + ")'>Delete</button>";
                newRow.appendChild(actionCell);



           

                // Append the new row to the table body
                tableBody.appendChild(newRow);
            }
        }

        // Function to edit the table row
        // function editRow(index) {
        //     // Get data from local storage
        //     var allData = JSON.parse(localStorage.getItem("allData")) || [];

        //     // Prompt the user to enter new data
        //     var newData = prompt("Enter new data (comma-separated):", allData[index].join(", "));

        //     // Update data in local storage
        //     if (newData !== null) {
        //         allData[index] = newData.split(", ");
        //         localStorage.setItem("allData", JSON.stringify(allData));
        //     }

        //     // Reload the data in the table
        //     loadData();
        // }










            // Function to edit the table row with a popup

            function editRow(index) {
    // Get data from local storage
    var allData = JSON.parse(localStorage.getItem("allData")) || [];

    // Get the existing data for the selected row
    var rowData = allData[index];

    // Define label names
    var labelName = ["","O.NO", "Name", "Rank", "part-ii","gcb", "id card no","date of joining ship","blood group","mobile no","mlr/vict","rmks"];

    // Display a popup with input fields for each value in the row
    var popupContent = '<div id="editPopup">';
    rowData.forEach((value, i) => {
        var displayStyle = i === 0 ? 'style="display: none;"' : '';

        popupContent += '<input ' + displayStyle + ' type="text" id="editInput' + i + '" value="' + value + '"> ';
        popupContent += '<label ' + displayStyle + ' for="editInput' + i + '">' + labelName[i] + ':</label> <br/>';
    });
    popupContent += ' <br/><button class="popupbtn" onclick="saveEditedRow(' + index + ')">Save</button>';
    popupContent += '</div>';

    // Append the popup to the body
    document.body.insertAdjacentHTML('beforeend', popupContent);
}










// Function to save the edited row data
function saveEditedRow(index) {
    // Get data from local storage
    var allData = JSON.parse(localStorage.getItem("allData")) || [];

    // Get the edited values from the popup
    var editedValues = [];
    allData[index].forEach((value, i) => {
        editedValues.push(document.getElementById('editInput' + i).value);
    });

    // Update data in local storage
    allData[index] = editedValues;
    localStorage.setItem("allData", JSON.stringify(allData));

    // Remove the popup
    document.getElementById('editPopup').remove();

    // Reload the data in the table or update the UI as needed
    loadData();
}



















        // Function to delete the table row
        function deleteRow(index) {
            // Get data from local storage
            var allData = JSON.parse(localStorage.getItem("allData")) || [];

            // Confirm deletion
            var confirmDelete = confirm("Are you sure you want to delete this row?");

            if (confirmDelete) {
                // Remove the specified row
                allData.splice(index, 1);

                // Update data in local storage
                localStorage.setItem("allData", JSON.stringify(allData));

                // Reload the data in the table
                loadData();
            }
        }

        // Load data when the page is loaded
        loadData();















window.onload = function () {
      // Get references to the table, search input, and result div
      var table = document.getElementById('myTable');
      var searchInput = document.getElementById('searchInput');
      var resultDiv = document.getElementById('resultDiv');

      // Set row numbers for all cells in the first column
      for (var i = 2; i < table.rows.length; i++) {
        var row = table.rows[i];
        row.cells[0].textContent = i - 1;
      }

      // Attach an event listener to the input for live searching
      searchInput.addEventListener('input', function () {
        var searchValue = escapeRegExp(searchInput.value.trim());

        // Create a regex pattern to match the beginning of any word (including special characters)
        var regexPattern = new RegExp('(?:\\b|^)' + searchValue, 'i');

        // Initialize visible row number
        var visibleRowNumber = 0;

        // Loop through each row in the table
        for (var i = 2; i < table.rows.length; i++) {
          var row = table.rows[i];
          var rowMatched = false;

          // Loop through each cell in the row starting from index 1
          for (var j = 1; j < row.cells.length; j++) {
            var cellText = row.cells[j].textContent;

            // Check if the cell text matches the regex pattern
            if (regexPattern.test(cellText)) {
              rowMatched = true;
              break; // Once a match is found in the row, no need to check other cells
            }
          }

          // Show or hide the row based on the search result
          if (rowMatched) {
            row.style.display = ''; // Show the row
            visibleRowNumber++;
          } else {
            row.style.display = 'none'; // Hide the row
          }

          // Set the first cell of each visible row with the corresponding visible row number
          if (row.style.display !== 'none') {
            row.cells[0].textContent = visibleRowNumber;
          }
        }

        // Update result div with the total number of visible rows
        resultDiv.innerHTML = 'Number of Visible Rows: ' + visibleRowNumber;
      });

      // Function to escape special characters in the search input for use in regex
      function escapeRegExp(string) {
        return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
      }
    };








// Bellow code are inly fir date function



    // Function to update the date and time in the specified format
    function updateDate() {
        var currentDate = new Date();
        var day = currentDate.getDate();
        var month = currentDate.getMonth() + 1;
        var year = currentDate.getFullYear().toString().slice(-2);
        day = (day < 10) ? '0' + day : day;
        month = (month < 10) ? '0' + month : month;

        var formattedDate = 'Date: '+ day + '/' + month + '/' + year;

        // Display the formatted date in the div with id "dateDisplay"
        document.getElementById('dateDisplay').innerText = formattedDate;
    }

    // Update the date initially
    updateDate();

    // Update the date every day at midnight (24 * 60 * 60 * 1000 milliseconds)
    setInterval(updateDate, 24 * 60 * 60 * 1000);









// all mlr vic, and,leave, ty, count 

function saveToLocalStorage() {
    const wordsToSearch = ['leave', 'ty', 'admit', 'run', 'vict', 'mlr'];
    const table = document.getElementById('myTable');

    // Initialize word count objects
    const wordCounts = {};
    wordsToSearch.forEach(word => (wordCounts[word] = 0));

    let presentCount = 0;
    let awayCount = 0;
    let totalRowCount = 0;

    // Loop through each row and cell in the table
    for (let i = 2; i < table.rows.length; i++) {
        totalRowCount++; // Increment total row count for each row

        for (let j = 0; j < table.rows[i].cells.length; j++) {
            const cellText = table.rows[i].cells[j].textContent.toLowerCase();

            // Count occurrences of each word
            wordsToSearch.forEach((word) => {
                const regex = new RegExp('\\b' + word + '\\b', 'g');
                const matches = (cellText.match(regex) || []).length;
                wordCounts[word] += matches;

                // Calculate additional counts
                if (word === 'vict' || word === 'mlr') {
                    presentCount += matches;
                } else if (word === 'ty' || word === 'leave' || word === 'run' || word === 'admit') {
                    awayCount += matches;
                }
            });
        }
    }

    // Save counts to local storage
     // Save each word count to local storage
     wordsToSearch.forEach(word => {
        localStorage.setItem(`${word}Count`, wordCounts[word]);
    });
    localStorage.setItem('presentCount', presentCount);
    localStorage.setItem('awayCount', awayCount);
    localStorage.setItem('totalRowCount', totalRowCount);
}

// Call the saveToLocalStorage function at regular intervals (e.g., every 1 second)
setInterval(saveToLocalStorage, 1000); // Save every 1 second (adjust as needed)













function searchAndCount() {
  let mcpo = ['mcpo', 'mcpo(reg)', 'mcpo(w)', 'mcpo(s)', 'mcpo(mus)', 'mcpo(com)', 'mcpo(med)', 'mcpo(ck)', 'mcpo(stw)', 'mcpo(r)', 'mcpo(l)', 'mcpo(e)'];
  let scpo = ['scpo', 'scpo(reg)', 'scpo(w)', 'scpo(s)', 'scpo(mus)', 'scpo(com)', 'scpo(med)', 'scpo(ck)', 'scpo(stw)', 'erea', 'cea', 'cera'];
  let cpo = ['cpo', 'maa', ' cpo(w)', 'cpo(s)', 'cpo(mus)', 'crs(g)', 'cpo(med)', 'cpo(ck)', 'cpo(stw)', 'rea-iii', 'rea-i', 'rea-ii', 'ea-iii', 'ea-i', 'ea-ii', 'era-iii', 'era-i', 'era-ii'];
  let po = ['Po', 'po(r)', ' po(w)', 'po(s)', 'po(mus)', 'pors(g)', 'po(med)', 'po(ck)', 'po(stw)', 'rea-iv', 'Ea-iv', 'Era-iv'];
  let ls = ['Ls', 'lpm', 'lrog', 'lma', 'lme', ' lme(s)', 'lwtr', 'lsa', 'lmus', 'ltop', 'lck', 'lstw'];
  let ab = ['pm-i', 'ab', 'sa-i', 'wtr-i', 'me-i', 'rog-i', 'ren-i', 'ma-i', 'top-i', 'mus-i', 'cook-i'];
  let od = ['pm-ii', 'od', 'sa-ii', 'wtr-ii', 'me-ii', 'rog-ii', 'ren-ii', 'ma-ii', 'top-ii', 'mus-ii', 'cook-ii'];

  const arraysToSearch = [mcpo, scpo, cpo, po, ls, ab, od];

  const table = document.getElementById('myTable');

  // Initialize total word count variables
  let totalMcpo = 0;
  let totalScpo = 0;
  let totalCpo = 0;
  let totalPo = 0;
  let totalLs = 0;
  let totalAb = 0;
  let totalOd = 0;

  // Loop through each row in the table (skipping header row)
  for (let i = 1; i < table.rows.length; i++) {
    const row = table.rows[i];

    // Loop through each cell in the row
    for (let j = 0; j < row.cells.length; j++) {
      const cellText = row.cells[j].textContent.toLowerCase();

      // Count occurrences of each word, considering whole word boundaries
      arraysToSearch.forEach((wordsArray, index) => {
        wordsArray.forEach(word => {
          const regex = new RegExp('\\b' + word + '\\b', 'g');
          const matches = (cellText.match(regex) || []).length;

          // Update total counts based on the array index
          switch (index) {
            case 0:
              totalMcpo += matches;
              break;
            case 1:
              totalScpo += matches;
              break;
            case 2:
              totalCpo += matches;
              break;
            case 3:
              totalPo += matches;
              break;
            case 4:
              totalLs += matches;
              break;
            case 5:
              totalAb += matches;
              break;
            case 6:
              totalOd += matches;
              break;
          }
        });
      });
    }
  }

  // Store the total counts in local storage
  localStorage.setItem('totalMcpo', totalMcpo);
  localStorage.setItem('totalScpo', totalScpo);
  localStorage.setItem('totalCpo', totalCpo);
  localStorage.setItem('totalPo', totalPo);
  localStorage.setItem('totalLs', totalLs);
  localStorage.setItem('totalAb', totalAb);
  localStorage.setItem('totalOd', totalOd);
}

// Call the function initially and then set an interval for regular updates
searchAndCount();
setInterval(searchAndCount, 1000);



    </script>
</body>
</html>